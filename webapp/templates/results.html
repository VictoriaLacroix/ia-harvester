{% extends "index.html" %}
{% block title %} - Search Results{% endblock %}
{% block content %}
{{ super() }}
{% for result in results['results'] %}
<script>
function show_more(elem) {
    var children = elem.parentNode.parentNode.childNodes;
    /* Display all child snippets */
    for (var i = 0; i < children.length; i++) {
        var child = children[i];
        if (child.tagName == 'DIV') {
            child.className = 'ressnip';
        } else if (child.tagName == 'P') {
            var kids = child.childNodes;
            for (var j = 0; j < kids.length; j++) {
                var kid = kids[j];
                kid.setAttribute('onclick', 'show_less(this);');
                kid.childNodes[0].nodeValue = ' - ';
            }
        }
    }
}
function show_less(elem) {
    var children = elem.parentNode.parentNode.childNodes;
    var found = false;
    for (var i = 0; i < children.length; i++) {
        var child = children[i];
        if (child.tagName == 'DIV') {
            /* Only hide the second and subsequent nodes */
            if (found) {
                child.className = 'ressnip hidden';
            }
            found = true;
        } else if (child.tagName == 'P') {
            child.childNodes[0].setAttribute('onclick', 'show_more(this);');
            child.childNodes[0].childNodes[0].nodeValue = ' + ';
        }
    }
}
</script>
    <div class="result">
        <h3 class="restitle">
            <a href="http://archive.org/details/{{ result['id'] }}">{{ result['title'] }}
        {% if result['date'] != '1900-01-01' %}
            <span class="resdate">({{ result['date'] }})</span>
        {% else %}
            {% if result['year'] != '1900' %}
                <span class="resyear">({{ result['year'] }})</span>
            {% endif %}
        {% endif %}</a>
        </h3>
        <div class="result-hdr">
    {% if result['collection'] == 'laurentianuniversitylambda' %}
            <div class="rescoll">Lambda</div>
    {% else %}
            <div class="rescoll"></div>
    {% endif %}
        </div>
        <div class="snippets">
    {% for snippet in result['snippets'] %}
        {% if loop.first %}
            <div class="ressnip">... {{ snippet }} ...</div>
        {% else %}
            <div class="ressnip hidden">... {{ snippet }} ...</div>
        {% endif %}
        {% if loop.last %}
            <p class="show_hide"><a onclick="show_more(this);"> + </a></p>
        {% endif %}
    {% endfor %}
        </div>
        <div class="thumb">
            <img src="/static/images/{{ result['id'] }}.gif" />
        </div>
    </div>
{% endfor %}
<section id="year_facet"><h4>Years</h4>
<ul>
{% if request.args.get('year') %}
    <li><a href="{{ request.base_url ~ '?query=' ~ terms }}"><span class="year">{{ request.args.get('year') }}</span></a> <strong>(X)</strong></li>
{% else %}
    {% for year in results['years'] %}
        {% if loop.index <= 10 %}
    <li><a href="{{ request.base_url ~ '?query=' ~ terms ~ '&amp;year=' ~ year[0] }}"><span class="year">{{ year[0] }}</span> <span>({{year[1]}})</span></a></li>
        {% endif %}
    {% endfor %}
{% endif %}
</ul>
</section>
<section id="collection_facet"><h4>Collections</h4>
<ul>
{% for col in results['collections'] %}
    {% if loop.index <= 10 %}
    <li><span class="collection">{{ col[0] }}</span> <span>({{col[1]}})</span></li>
    {% endif %}
{% endfor %}
</ul>
</section>
{% endblock %}
